package com.aura.engine.module.shell;

import java.awt.Color;
import java.awt.Composite;
import java.awt.Graphics2D;
import java.util.ArrayList;
import java.util.List;

import com.aura.base.utils.Validate;
import com.aura.engine.AuraEngine;

public class MObject {
	private final AuraEngine scene;
	private final String text;
	private final int w, h;
	private final List<MObjectAction> actions;
	
	private boolean visible;
	
	public MObject(AuraEngine scene, String text, int w, int h) {
		this.scene = scene;
		this.text = text;
		
		this.w = w; 
		this.h = h;
		
		this.actions = new ArrayList<MObjectAction>();
		this.visible = true;
	}
	
	public int getW() { return w; }
	public int getH() { return h; }
	
	private int tempX, tempY;
	
	public void draw(Graphics2D g, int x, int y) {
		this.tempX = x;
		this.tempY = y;
		
		Composite temp = g.getComposite();
		g.setColor(Color.ORANGE);
		
		scene.setComposite(g, .50f);
		g.fillRect(x, y, w, h);
		scene.setComposite(g, temp);
		
		g.drawRect(x, y, w, h);
		
		if (text != null) {
			g.setColor(Color.BLACK);
			g.drawString(text, 
				x + (w/2) - (g.getFontMetrics().stringWidth(text)/2), 
				y + (h/2) + 5);
		}
	}
	
	public boolean isVisible() {
		return visible;
	}
	public void setVisible(boolean visible) {
		this.visible = visible;
	}
	
	public boolean intersect(int xcur, int ycur) {
		return xcur >= tempX 
				&& xcur <= tempX+w
				&& ycur >= tempY
				&& ycur <= tempY+h;
	}
	
	public void attach(MObjectAction action) {
		Validate.notNull(action);
		actions.add(action);
	}
	public void actionExecute() {
		for (MObjectAction a: actions)
			if (a != null)
				a.execute();
	}
}